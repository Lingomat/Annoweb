<div layout="row" flex>
    <section layout="column" resizable class="md-padding" r-directions="['right']" r-flex="false" style="width:60%">
        <div id="annotate-timeline" style="height:20px" layout-fill></div>
        <div id="annotatePlayback"></div>

        <div layout="row" layout-align="start center">

            <md-icon md-svg-src="img/icons/technology.svg" style="width:24px;height:24px;margin-left:8px;" aria-label="Recordings"></md-icon>

            <md-button ng-repeat="source in annoC.audioSourceList.slice(1)" aria-label="{{source.name}}">
                <md-icon class="imgsvgicon" ng-style="source.color" md-svg-icon="{{source.icon}}"></md-icon>
                <span>{{source.name | translate}}</span>
            </md-button>

            <span flex></span>

            <md-button class="md-icon-button" aria-label="Use translation" ng-click="annoC.help($event)">
                <md-tooltip class="md-body-2">{{"ACTIVITY_HELP" | translate}}</md-tooltip>
                <md-icon class="imgsvgicon" md-svg-icon="action:help"></md-icon>
            </md-button>

        </div>


        <section>
            <div ng-repeat="anno in annoC.annoList" layout="row" layout-align="start center">

                <md-menu>
                    <md-button class="md-icon-button" ng-disabled="!annoC.annoSettings[$index].enabled" aria-label="Playback menu" ng-click="annoC.openMenu($mdOpenMenu, $event)">
                        <md-tooltip class="md-body-2">{{"PLAY_SRC" | translate}}</md-tooltip>
                        <md-icon md-menu-origin class="imgsvgicon" md-svg-src="img/icons/speaker_on.svg"></md-icon>
                    </md-button>
                    <md-menu-content width="4">
                        <md-menu-item >
                            <md-button ng-click="annoC.toggleSourcePlayback($index)">
                                <md-icon ng-if="annoC.sourcePlayback[$index]" class="imgsvgicon" md-svg-src="img/icons/speaker_on.svg"></md-icon>
                                <md-icon ng-if="!annoC.sourcePlayback[$index]" class="imgsvgicon" md-svg-src="img/icons/speaker_off.svg"></md-icon>
                                <span class="md-body-2">{{"PLAY_SRC" | translate}}</span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item ng-repeat="respk in annoC.respeakings" ng-init="annoIndex = anno._ID">
                            <md-button ng-click="annoC.toggleRespeaking(annoIndex, $index)">
                                <md-icon ng-if="annoC.isRspkActive(annoIndex, $index)" class="imgsvgicon" md-svg-src="img/icons/speaker_on.svg"></md-icon>
                                <md-icon ng-if="!annoC.isRspkActive(annoIndex, $index)" class="imgsvgicon" md-svg-src="img/icons/speaker_off.svg"></md-icon>
                                <span class="md-body-2">{{"RESPEAKING" | translate}} {{$index + 1}} <i>{{respk.source.created | date:'dd/MM/yyyy'}}</i></span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item ng-repeat="trans in annoC.translations" ng-init="annoIndex = anno._ID">
                            <md-button ng-click="annoC.toggleTranslation(annoIndex, $index)">
                                <md-icon ng-if="annoC.isTransActive(annoIndex, $index)" class="imgsvgicon" md-svg-src="img/icons/speaker_on.svg"></md-icon>
                                <md-icon ng-if="!annoC.isTransActive(annoIndex, $index)" class="imgsvgicon" md-svg-src="img/icons/speaker_off.svg"></md-icon>
                                <span class="md-body-2">{{"TRANSLATE" | translate}} {{$index + 1}} <i>{{trans.source.created | date:'dd/MM/yyyy'}}</i></span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button ng-click="annoC.toggleAnnoSetting($index, 'loop')">
                                <span ng-if="annoC.annoSettings[$index].loop" class="md-body-2"><md-icon class="imgsvgicon" md-svg-icon="av:loop"></md-icon> {{"PLAY_LOOP" | translate}}</span>
                                <span ng-if="!annoC.annoSettings[$index].loop" class="md-body-2"><md-icon class="imgsvgicon" md-svg-icon="av:play_arrow"></md-icon> {{"PLAY_ONCE" | translate}}</span>
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>


                <md-input-container flex class="md-block1">
                    <label class="md-subhead"><span style="text-transform: uppercase">{{anno.type | translate}}</span>: {{anno.name}}</label>
                    <input class="md-body-1" focus-on="{{'inputfoo'+$index}}" ng-model="annoC.annotations[$index].data.segment.annotations[annoC.curRegion]"
                           ng-focus="annoC.selectAnno($index)"
                           ng-disabled="!annoC.annoSettings[$index].enabled || annoC.curRegion < 0"
                           ng-keyup="$event.keyCode == 13 && annoC.inputReturn($index)">
                </md-input-container>


                <md-input-container>
                    <md-tooltip class="md-body-2">{{"ANNO_TOG" | translate}}</md-tooltip>
                    <md-switch ng-model="annoC.annoSettings[$index].enabled" aria-label="Enable disable">
                    </md-switch>
                </md-input-container>

                <md-menu>
                    <md-button class="md-icon-button" aria-label="Track menu" ng-click="annoC.openMenu($mdOpenMenu, $event)">
                        <md-tooltip class="md-body-2">Track</md-tooltip>
                        <md-icon md-menu-origin class="imgsvgicon"
                                 ng-style="annoC.audioSourceList[annoC.annoSettings[$index].selectedTrack].color" md-svg-icon="{{annoC.audioSourceList[annoC.annoSettings[$index].selectedTrack].icon}}"></md-icon>
                    </md-button>
                    <md-menu-content width="3" ng-init="aIdx = $index">
                        <md-menu-item ng-repeat="source in annoC.audioSourceList">
                            <md-button ng-click="annoC.copyTrackConf($event, aIdx, $index)">
                                <md-icon class="imgsvgicon" ng-style="source.color" md-svg-icon="{{source.icon}}"></md-icon>
                                <span class="md-body-2">{{source.action | translate}}</span>
                            </md-button>
                        </md-menu-item>
                        <md-menu-item>
                            <md-button ng-click="annoC.clearAnno(aIdx)">
                            <md-icon class="imgsvgicon md-warn" md-svg-icon="content:clear"></md-icon>
                            <span class="md-body-2">{{"CLEAR_ALL" | translate}}</span>
                            </md-button>
                        </md-menu-item>
                    </md-menu-content>
                </md-menu>

            </div>

        </section>

    </section>
    <md-content flex layout="column" class="md-whiteframe-3dp md-padding" style="width:40%;overflow-y: scroll">
        <div ng-if="!annoC.annotations[annoC.selectedAnno].data.segment.annotations" class="md-body-2"><i>{{"NONE" | translate}}</i></div>
        <div ng-repeat="anno in annoC.annotations[annoC.selectedAnno].data.segment.annotations track by $index"
             ng-class="($index == annoC.curRegion) ? 'transcript-highlight' : 'transcript-normal'"
             ng-click="annoC.seekRegion($index)">
            <span class="md-body-1">{{anno}}</span>
        </div>
    </md-content>

</div>

